The non-Lua parts were written by John D. Ramsdell
